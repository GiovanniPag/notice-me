<form *ngIf="note" name="editForm" role="form" novalidate (ngSubmit)="save()" [formGroup]="editForm">
  <div class="form-group" [hidden]="true">
    <input type="number" class="form-control" name="id" id="field_id" data-cy="id" formControlName="id" [readonly]="true" />
  </div>

  <div class="modal-body">
    <jhi-alert-error></jhi-alert-error>

    <div class="form-group">
      <input
        type="text"
        class="form-control"
        placeholder="{{ 'noticeMeApp.note.title' | translate }}"
        name="title"
        id="field_title"
        data-cy="title"
        formControlName="title"
      />
      <div *ngIf="editForm.get('title')!.invalid && (editForm.get('title')!.dirty || editForm.get('title')!.touched)">
        <small class="form-text text-danger" *ngIf="editForm.get('title')?.errors?.required" jhiTranslate="entity.validation.required">
          This field is required.
        </small>
        <small
          class="form-text text-danger"
          *ngIf="editForm.get('title')?.errors?.minlength"
          jhiTranslate="entity.validation.minlength"
          [translateValues]="{ min: 1 }"
        >
          This field is required to be at least 1 characters.
        </small>
      </div>
    </div>

    <div class="form-group">
      <label class="form-control-label" jhiTranslate="noticeMeApp.note.content" for="field_content">Content</label>
      <textarea class="form-control" name="content" id="field_content" data-cy="content" formControlName="content"></textarea>
      <div *ngIf="editForm.get('content')!.invalid && (editForm.get('content')!.dirty || editForm.get('content')!.touched)">
        <small class="form-text text-danger" *ngIf="editForm.get('content')?.errors?.required" jhiTranslate="entity.validation.required">
          This field is required.
        </small>
      </div>
    </div>

    <div class="form-group">
      <label class="form-control-label" jhiTranslate="noticeMeApp.note.date" for="field_date">Date</label>
      <div class="d-flex">
        <input
          id="field_date"
          data-cy="date"
          type="datetime-local"
          class="form-control"
          name="date"
          formControlName="date"
          placeholder="YYYY-MM-DD HH:mm"
        />
      </div>
      <div *ngIf="editForm.get('date')!.invalid && (editForm.get('date')!.dirty || editForm.get('date')!.touched)">
        <small class="form-text text-danger" *ngIf="editForm.get('date')?.errors?.required" jhiTranslate="entity.validation.required">
          This field is required.
        </small>
        <small
          class="form-text text-danger"
          [hidden]="!editForm.get('date')?.errors?.ZonedDateTimelocal"
          jhiTranslate="entity.validation.ZonedDateTimelocal"
        >
          This field should be a date and time.
        </small>
      </div>
    </div>

    <div class="form-group">
      <label class="form-control-label" jhiTranslate="noticeMeApp.note.alarm" for="field_alarm">Alarm</label>
      <div class="d-flex">
        <input
          id="field_alarm"
          data-cy="alarm"
          type="datetime-local"
          class="form-control"
          name="alarm"
          formControlName="alarm"
          placeholder="YYYY-MM-DD HH:mm"
        />
      </div>
    </div>

    <div class="form-group">
      <label class="form-control-label" jhiTranslate="noticeMeApp.note.status" for="field_status">Status</label>
      <select class="form-control" name="status" formControlName="status" id="field_status" data-cy="status">
        <option [ngValue]="null">{{ 'noticeMeApp.NoteStatus.null' | translate }}</option>
        <option value="NORMAL">{{ 'noticeMeApp.NoteStatus.NORMAL' | translate }}</option>
        <option value="ALARM">{{ 'noticeMeApp.NoteStatus.ALARM' | translate }}</option>
        <option value="ARCHIVED">{{ 'noticeMeApp.NoteStatus.ARCHIVED' | translate }}</option>
        <option value="DELETED">{{ 'noticeMeApp.NoteStatus.DELETED' | translate }}</option>
      </select>
      <div *ngIf="editForm.get('status')!.invalid && (editForm.get('status')!.dirty || editForm.get('status')!.touched)">
        <small class="form-text text-danger" *ngIf="editForm.get('status')?.errors?.required" jhiTranslate="entity.validation.required">
          This field is required.
        </small>
      </div>
    </div>

    <div class="form-group">
      <label class="form-control-label" jhiTranslate="noticeMeApp.note.owner" for="field_owner">Owner</label>
      <select class="form-control" id="field_owner" data-cy="owner" name="owner" formControlName="owner">
        <option *ngIf="!editForm.get('owner')!.value" [ngValue]="null" selected></option>
        <option
          [ngValue]="userOption.id === editForm.get('owner')!.value?.id ? editForm.get('owner')!.value : userOption"
          *ngFor="let userOption of usersSharedCollection; trackBy: trackUserById"
        >
          {{ userOption.id }}
        </option>
      </select>
    </div>
    <div *ngIf="editForm.get(['owner'])!.invalid && (editForm.get(['owner'])!.dirty || editForm.get(['owner'])!.touched)">
      <small class="form-text text-danger" *ngIf="editForm.get(['owner'])?.errors?.required" jhiTranslate="entity.validation.required">
        This field is required.
      </small>
    </div>

    <div class="form-group">
      <label jhiTranslate="noticeMeApp.note.tag" for="field_tags">Tag</label>
      <select class="form-control" id="field_tags" data-cy="tag" multiple name="tags" formControlName="tags">
        <option
          [ngValue]="getSelectedTag(tagOption, editForm.get('tags')!.value)"
          *ngFor="let tagOption of tagsSharedCollection; trackBy: trackTagById"
        >
          {{ tagOption.tagName }}
        </option>
      </select>
    </div>

    <div class="form-group">
      <label jhiTranslate="noticeMeApp.note.collaborator" for="field_collaborators">Collaborator</label>
      <select
        class="form-control"
        id="field_collaborators"
        data-cy="collaborator"
        multiple
        name="collaborators"
        formControlName="collaborators"
      >
        <option
          [ngValue]="getSelectedUser(userOption, editForm.get('collaborators')!.value)"
          *ngFor="let userOption of usersSharedCollection; trackBy: trackUserById"
        >
          {{ userOption.id }}
        </option>
      </select>
    </div>
  </div>

  <dl class="row-md jh-entity-details">
    <dt>
      <span jhiTranslate="noticeMeApp.note.title">Title</span>
    </dt>
    <dd>
      <span>{{ note.title }}</span>
    </dd>
    <dt>
      <span jhiTranslate="noticeMeApp.note.content">Content</span>
    </dt>
    <dd>
      <span>{{ note.content }}</span>
    </dd>
    <dt>
      <span jhiTranslate="noticeMeApp.note.date">Date</span>
    </dt>
    <dd>
      <span>{{ note.date | formatMediumDatetime }}</span>
    </dd>
    <dt>
      <span jhiTranslate="noticeMeApp.note.alarm">Alarm</span>
    </dt>
    <dd>
      <span>{{ note.alarm | formatMediumDatetime }}</span>
    </dd>
    <dt>
      <span jhiTranslate="noticeMeApp.note.status">Status</span>
    </dt>
    <dd>
      <span jhiTranslate="{{ 'noticeMeApp.NoteStatus.' + note.status }}">{{ note.status }}</span>
    </dd>
    <dt>
      <span jhiTranslate="noticeMeApp.note.owner">Owner</span>
    </dt>
    <dd>
      <span>{{ note.owner?.id }}</span>
    </dd>
    <dt>
      <span jhiTranslate="noticeMeApp.note.tag">Tag</span>
    </dt>
    <dd>
      <span *ngFor="let tag of note.tags; let last = last">
        <a [routerLink]="['/tag', tag?.id, 'view']">{{ tag.tagName }}</a>
        {{ last ? '' : ', ' }}
      </span>
    </dd>
    <dt>
      <span jhiTranslate="noticeMeApp.note.collaborator">Collaborator</span>
    </dt>
    <dd>
      <span *ngFor="let collaborator of note.collaborators; let last = last"> {{ collaborator.id }}{{ last ? '' : ', ' }} </span>
    </dd>
  </dl>
  <div class="modal-footer">
    <button
      type="button"
      id="cancel-save"
      data-dismiss="modal"
      aria-hidden="true"
      class="btn btn-primary"
      data-dismiss="modal"
      (click)="close()"
      data-cy="entityDetailsCloseButton"
    >
      <fa-icon icon="arrow-left"></fa-icon>
      &nbsp;
      <span jhiTranslate="entity.action.close">Close</span>
    </button>

    <button
      type="submit"
      id="save-entity"
      data-cy="entityCreateSaveButton"
      [disabled]="editForm.invalid || isSaving"
      class="btn btn-primary"
    >
      <fa-icon icon="save"></fa-icon>
      &nbsp;
      <span jhiTranslate="entity.action.save">Save</span>
    </button>
  </div>
</form>
